<div id="card_modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-center justify-center"
     data-controller="card-modal"
     data-action="click->card-modal#closeOnBackdrop keydown@window->card-modal#closeOnEscape">
  <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4">
    <div class="p-6">
      <div class="flex justify-between items-start mb-4">
        <h3 class="text-lg font-medium text-gray-900"><%= card.title %></h3>
        <div class="flex space-x-2">
          <%= link_to edit_project_list_card_path(card.list.project, card.list, card),
                      class: "text-blue-600 hover:text-blue-800",
                      data: { turbo_method: :get } do %>
            ✏️
          <% end %>
          <%= link_to project_list_card_path(card.list.project, card.list, card),
                      method: :delete,
                      class: "text-red-600 hover:text-red-800",
                      confirm: "Tem certeza que deseja remover este card?",
                      data: {
                        turbo_method: :delete,
                        action: "click->card-modal#close"
                      } do %>
            🗑️
          <% end %>
        </div>
      </div>

      <% if card.description.present? %>
        <div class="mb-4">
          <h4 class="text-sm font-medium text-gray-700 mb-2">Descrição</h4>
          <p class="text-gray-600 text-sm whitespace-pre-wrap"><%= card.description %></p>
        </div>
      <% end %>

      <div class="space-y-3 mb-6">
        <% if card.due_date %>
          <div class="flex items-center space-x-2">
            <span class="text-sm font-medium text-gray-700">📅 Data de Entrega:</span>
            <span class="text-sm <%= card.due_date < Date.current ? 'text-red-600 font-medium' : 'text-gray-600' %>">
              <%= card.due_date.strftime("%d/%m/%Y") %>
              <% if card.due_date < Date.current %>
                (Atrasado)
              <% elsif card.due_date == Date.current %>
                (Hoje)
              <% end %>
            </span>
          </div>
        <% end %>

        <% if card.assignee %>
          <div class="flex items-center space-x-2">
            <span class="text-sm font-medium text-gray-700">👤 Responsável:</span>
            <span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full">
              <%= card.assignee.name %>
            </span>
          </div>
        <% end %>

        <div class="flex items-center space-x-2">
          <span class="text-sm font-medium text-gray-700">📋 Lista:</span>
          <span class="bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded-full">
            <%= card.list.title %>
          </span>
        </div>

        <div class="flex items-center space-x-2">
          <span class="text-sm font-medium text-gray-700">📅 Criado:</span>
          <span class="text-sm text-gray-600">
            <%= card.created_at.strftime("%d/%m/%Y às %H:%M") %>
          </span>
        </div>
      </div>

      <div class="flex justify-end space-x-3">
        <button type="button"
                data-action="click->card-modal#close"
                class="bg-gray-300 hover:bg-gray-400 text-gray-700 px-4 py-2 rounded-lg">
          Fechar
        </button>
        <%= link_to "Editar",
                    edit_project_list_card_path(card.list.project, card.list, card),
                    class: "bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg",
                    data: { turbo_method: :get } %>
      </div>
    </div>
  </div>
</div>
